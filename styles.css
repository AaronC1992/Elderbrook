:root{
  --bg:#0e0f12; --panel:#171a1f; --text:#e7eaf0; --muted:#9aa3af;
  --accent:#4aa3ff; --accent-2:#8b5cf6; --danger:#ef4444; --ok:#10b981;
  --hp:#ef4444; --mp:#60a5fa; --cd:#f59e0b;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font:14px/1.5 system-ui,Segoe UI,Roboto,Arial,sans-serif;
  position:relative;
  overflow-x:hidden;
}

/* Dynamic backgrounds with overlay */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0;
  transition: opacity 0.6s ease-in-out;
  z-index: -1;
}

/* Background overlays for readability - removed for village to show buildings clearly */
body::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: transparent; /* Removed overlay for clear view of village */
  z-index: -1;
}

/* Town background - increased opacity to see buildings */
body.bg-town::before {
  background-image: url('backgrounds/Elderbrook-village.jpg');
  opacity: 1; /* Full visibility for village */
}

/* Forest background */
body.bg-forest::before {
  background-image: url('./backgrounds/Forrest-1.png');
  opacity: 0.35;
}

/* Cave background */
body.bg-cave::before {
  background-image: url('./backgrounds/Cave-1.png');
  opacity: 0.3;
}

/* Grove background */
body.bg-grove::before {
  background-image: url('./backgrounds/forrest-boss.png');
  opacity: 0.32;
}

/* Ruins background */
body.bg-ruins::before {
  background-image: url('./backgrounds/forrest-boss.png');
  opacity: 0.32;
}

/* Depths background */
body.bg-depths::before {
  background-image: url('./backgrounds/forrest-boss.png');
  opacity: 0.28;
}

/* Shops and questboard backgrounds */
body.bg-weapon-shop::before { background-image: url('backgrounds/elderbrook-village-weapon-shop.png'); opacity: 1; }
body.bg-armor-shop::before { background-image: url('backgrounds/elderbrook-village-armor-shop.png'); opacity: 1; }
body.bg-potion-shop::before { background-image: url('backgrounds/elderbrook-village-potion-shop.png'); opacity: 1; }
body.bg-questboard::before { background-image: url('backgrounds/elderbrook-village-questboard.png'); opacity: 1; }

/* Disable background transitions when animations off */
body.disable-animations::before {
  transition: none !important;
}

/* Momentum bar styling */
.bar.momentum { background:#1e2430; height:6px; margin-top:4px; position:relative; }
.bar.momentum > div { background:linear-gradient(90deg,#2563eb,#7c3aed); height:100%; width:0%; transition:width .15s linear; }

/* Enemy special telegraph */
.enemy-special-windup { color:#f87171; font-weight:bold; font-size:12px; margin-left:4px; animation:pulse-glow 1.6s ease-in-out infinite; }
.enemy-special-soon { color:#fb923c; font-size:11px; margin-left:4px; }

/* Floating damage numbers */
.floating-dmg { position:absolute; left:50%; top:20%; transform:translateX(-50%); pointer-events:none; font-weight:600; opacity:0; animation:float-dmg 0.9s ease-out forwards; text-shadow:0 0 4px rgba(0,0,0,0.5); }
.floating-dmg.normal { color:#f87171; }
.floating-dmg.crit { color:#fbbf24; font-size:16px; text-shadow:0 0 6px rgba(251,191,36,0.6); }
.floating-dmg.block { color:#94a3b8; }
@keyframes float-dmg { 0% { opacity:0; transform:translate(-50%,0); } 10% { opacity:1; } 80% { opacity:1; transform:translate(-50%,-28px); } 100% { opacity:0; transform:translate(-50%,-32px); } }
#game-root{max-width:1000px;margin:24px auto;padding:0 16px}
.hidden{display:none !important}
.screen{padding:8px}

/* Full-page screens (title, character creation) */
.screen.full-page {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  padding: 0;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
}
.screen.full-page.hidden {
  display: none;
}

.panel{background:var(--panel);border:1px solid #22262e;border-radius:10px;padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.35)}

/* Title Screen */
.title-screen {
  text-align: center;
  padding: 48px 32px;
  max-width: 500px;
  margin: 0 auto;
}
.title-logo {
  font-size: 48px;
  margin-bottom: 8px;
  background: linear-gradient(135deg, #4aa3ff, #8b5cf6);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 700;
  letter-spacing: 2px;
}
.title-subtitle {
  font-size: 16px;
  color: var(--muted);
  margin: 0 0 40px;
  font-style: italic;
}
.title-buttons {
  gap: 12px;
}
.title-buttons button {
  font-size: 16px;
  padding: 12px 24px;
}

/* Character Creation Screen */
.character-creation-screen {
  max-width: 600px;
  margin: 0 auto;
  max-height: 90vh;
  overflow-y: auto;
}

/* Village Map Interactive Layout */
.village-map {
  max-width: 900px;
  margin: 0 auto;
  padding: 16px;
  position: relative;
}

/* Development Grid Overlay - Remove after mapping buildings */
.village-map.show-grid::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 9999;
  background-image: 
    repeating-linear-gradient(0deg, rgba(255,0,0,0.3) 0px, rgba(255,0,0,0.3) 1px, transparent 1px, transparent 50px),
    repeating-linear-gradient(90deg, rgba(255,0,0,0.3) 0px, rgba(255,0,0,0.3) 1px, transparent 1px, transparent 50px);
  background-size: 50px 50px;
}

.village-grid-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 99999;
  display: none;
}

.village-grid-overlay.active {
  display: grid;
  grid-template-columns: repeat(20, 1fr);
  grid-template-rows: repeat(15, 1fr);
  gap: 1px;
}

.grid-cell {
  border: 1px solid rgba(255, 0, 0, 0.4);
  background: rgba(255, 255, 0, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: bold;
  color: #fff;
  text-shadow: 0 0 3px #000, 0 0 3px #000;
}

.village-arrow {
  position: fixed;
  width: 40px;
  height: 40px;
  background-image: url('backgrounds/Direction-Arrow.png');
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-color: transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 10;
  filter: drop-shadow(0 2px 8px rgba(0,0,0,0.4));
}
.village-arrow:hover {
  filter: drop-shadow(0 4px 12px rgba(74,163,255,0.5));
}

.village-hud {
  background: var(--panel);
  border: 1px solid #22262e;
  border-radius: 10px;
  padding: 12px 16px;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  flex-wrap: wrap;
}

.village-hud-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.village-hud-buttons button {
  font-size: 12px;
  padding: 6px 10px;
}

.village-scene {
  /* Remove the panel background - just show the background image */
  position: relative;
  min-height: 600px;
  /* This will be where clickable hotspots are positioned */
}

/* Hotspots overlay */
.village-hotspots {
  position: fixed; /* align with full-screen grid overlay */
  inset: 0;
  pointer-events: none; /* container doesn't block; children will */
  z-index: 9; /* above background, below most UI */
}

.hotspot {
  position: absolute;
  pointer-events: auto;
  /* Invisible by default; debug styles commented */
  /* border: 2px dashed rgba(74,163,255,0.55);
  background: rgba(74,163,255,0.12); */
  border: none;
  background: transparent;
  border-radius: 8px;
  transition: transform 0.08s ease-in-out, background 0.12s;
}
.hotspot:hover {
  background: rgba(74,163,255,0.12);
  transform: translateZ(0) scale(1.02);
}
.hotspot[data-label]::after {
  content: '';
}

/* Back arrow for shop and other sub-screens */
.back-arrow {
  position: fixed;
  top: 20px;
  left: 20px;
  width: 50px;
  height: 50px;
  background-image: url('backgrounds/Direction-Arrow.png');
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-color: transparent;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 1000;
  transform: rotate(90deg);
  filter: drop-shadow(0 4px 12px rgba(0,0,0,0.4));
}
.back-arrow:hover {
  transform: rotate(90deg) scale(1.08);
  filter: drop-shadow(0 6px 16px rgba(74,163,255,0.5));
}
.back-arrow:active {
  transform: rotate(90deg) scale(0.95);
}

/* Grid toggle button for shops */
.toggle-grid-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 10px 16px;
  background: linear-gradient(135deg, var(--panel), #1a1f28);
  border: 2px solid var(--accent-2);
  border-radius: 8px;
  color: var(--accent-2);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
}
.toggle-grid-btn:hover {
  background: linear-gradient(135deg, #1e2530, var(--panel));
  border-color: #a78bfa;
  transform: scale(1.05);
  box-shadow: 0 6px 16px rgba(139,92,246,0.3);
}
.toggle-grid-btn:active {
  transform: scale(0.95);
}

/* CSS-drawn shopkeeper NPC */
.npc-shopkeeper {
  position: fixed;
  width: 80px;
  height: 120px;
  cursor: pointer;
  z-index: 8;
  transition: transform 0.15s ease;
}
.npc-shopkeeper:hover {
  transform: scale(1.05);
}
/* Head */
.npc-shopkeeper::before {
  content: '';
  position: absolute;
  left: 50%;
  top: 10px;
  width: 45px;
  height: 45px;
  transform: translateX(-50%);
  background: radial-gradient(circle at 35% 30%, #f4d4a8, #d4a574);
  border-radius: 50%;
  box-shadow: inset 0 -4px 6px rgba(0,0,0,0.15);
}
/* Body */
.npc-shopkeeper::after {
  content: '';
  position: absolute;
  left: 50%;
  top: 55px;
  width: 60px;
  height: 60px;
  transform: translateX(-50%);
  background: linear-gradient(180deg, #6b7280 0%, #4b5563 100%);
  border-radius: 8px 8px 12px 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

.village-title {
  display: none; /* Hide the title */
}

.village-buildings {
  display: none; /* Hide the card-based building menu */
}

.village-zones {
  display: none; /* Hide the exploration menu - will use clickable paths instead */
}

h1{margin:0 0 8px;font-size:28px;letter-spacing:.5px}
h2{margin:0 0 12px;font-size:20px;color:#ced4dd}
.form-row{margin:12px 0}
label{display:block;margin-bottom:6px;color:var(--muted)}
input[type="text"]{width:100%;padding:8px 10px;border-radius:8px;border:1px solid #2a2f38;background:#0f1216;color:var(--text)}
.radio-row{display:flex;gap:16px}
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.stat{background:#0f1216;border:1px solid #262b34;border-radius:8px;padding:8px;text-align:center}
.stat-controls{display:flex;gap:8px;align-items:center;justify-content:center;margin-top:6px}
button{appearance:none;border:1px solid #2b313b;background:#12161b;color:var(--text);padding:8px 12px;border-radius:8px;cursor:pointer}
button:hover{border-color:#3a4350}
button.primary{background:linear-gradient(180deg,#1a6bf0,#144fb3);border-color:#1e51b2}
button.primary:disabled{opacity:.5}
button.danger{background:linear-gradient(180deg,#c73535,#981b1b);border-color:#7f1d1d}
.row{display:flex;align-items:center;gap:12px}
.row.right{justify-content:flex-end}
.row.gap{gap:8px}
.column{display:flex;flex-direction:column;gap:8px}
.battle-top{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.combatant .name{font-weight:700}
.combatant .meta{color:var(--muted);font-size:12px}
.bar{height:12px;background:#0f1216;border:1px solid #262b34;border-radius:6px;overflow:hidden;margin:6px 0}
.bar > div{height:100%;width:0%}
.bar.hp > div{background:linear-gradient(90deg,#ef4444,#f97316)}
.bar.mp > div{background:linear-gradient(90deg,#60a5fa,#22d3ee)}
.bar.cd > div{background:linear-gradient(90deg,#f59e0b,#fde047)}
.values{color:#cbd5e1;font-size:12px}
.battle-actions{display:flex;gap:8px;margin:12px 0;flex-wrap:wrap}
.battle-log{max-height:220px;overflow:auto;border:1px solid #262b34;border-radius:8px;padding:8px;background:#0f1216}
.battle-log ul{list-style:none;margin:0;padding:0}
.battle-log li{padding:4px 2px;color:#cbd5e1}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center}
.modal-content{max-width:520px}

/* Talents UI */
#screen-talents h2{margin-top:0}
#talents-tabs{margin-bottom:12px}
#talents-content .row{justify-content:space-between;align-items:flex-start;border:1px solid #262b34;background:#12161b;padding:10px;border-radius:8px;flex-wrap:wrap}
.talent-locked{opacity:.45;filter:grayscale(.4)}
.talent-taken{border-color:var(--ok);background:#10221a}
.talent-meta{font-size:11px;color:var(--muted);margin-top:4px}
.talent-name{font-weight:600}
.talent-requirements{font-size:11px;color:#fbbf24}
.talent-spend-btn{min-width:80px}

/* Boss button highlight */
#btn-boss{background:linear-gradient(180deg,#5e3aa7,#432c7a);border-color:#4c2f86}
#btn-boss:hover{border-color:#6d42c3}

/* Animations & Visual Effects */
@keyframes hit-flash {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.8) drop-shadow(0 0 8px rgba(255,100,100,0.8)); }
}
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-4px); }
  75% { transform: translateX(4px); }
}
@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 4px rgba(74, 163, 255, 0.3); }
  50% { box-shadow: 0 0 12px rgba(74, 163, 255, 0.6); }
}
@keyframes screen-fade-in {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Apply animations */
.hit-flash { animation: hit-flash 0.4s ease-out; }
.shake { animation: shake 0.3s ease-out; }
button:hover:not(:disabled) { animation: pulse-glow 2s ease-in-out infinite; }
.screen:not(.hidden) { animation: screen-fade-in 0.3s ease-out; }

/* Disable animations when user prefers */
body.disable-animations .hit-flash,
body.disable-animations .shake,
body.disable-animations button:hover:not(:disabled),
body.disable-animations .screen:not(.hidden) {
  animation: none !important;
}

/* Status effect icons */
.status-effects {
  display: flex;
  gap: 4px;
  margin-top: 4px;
  flex-wrap: wrap;
}
.status-icon {
  display: inline-block;
  width: 20px;
  height: 20px;
  border-radius: 4px;
  font-size: 10px;
  text-align: center;
  line-height: 20px;
  position: relative;
  cursor: help;
}
.status-icon.poison { background: #10b981; color: #fff; }
.status-icon.burn { background: #f97316; color: #fff; }
.status-icon.stun { background: #fbbf24; color: #000; }
.status-icon:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.9);
  color: #fff;
  padding: 4px 8px;
  border-radius: 4px;
  white-space: nowrap;
  font-size: 11px;
  z-index: 100;
  margin-bottom: 4px;
  pointer-events: none;
}

/* Combat log enhancements */
.battle-log li.damage { color: #f87171; }
.battle-log li.heal { color: #4ade80; }
.battle-log li.crit { color: #fbbf24; font-weight: 600; }
.battle-log li.status { color: #a78bfa; }
.battle-log li.info { color: #60a5fa; }
.battle-log li.victory { color: #10b981; font-weight: 600; }
.battle-log li.defeat { color: #ef4444; font-weight: 600; }
.battle-log li.boss { color: #f472b6; font-weight: 700; }

/* Warning flash overlay for deadly telegraphs */
@keyframes warning-flash-anim {
  0% { box-shadow: inset 0 0 0 0 rgba(239,68,68,0.0); }
  40% { box-shadow: inset 0 0 0 120vmax rgba(239,68,68,0.2); }
  100% { box-shadow: inset 0 0 0 0 rgba(239,68,68,0.0); }
}
body.warning-flash::after {
  animation: warning-flash-anim 0.6s ease-out 1;
}

/* Item rarity colors */
.item-common { color: #9ca3af; }
.item-uncommon { color: #4ade80; }
.item-rare { color: #60a5fa; }
.item-epic { color: #a78bfa; }
.item-legendary { color: #f59e0b; }

/* Item tooltips */
.item-tooltip {
  position: relative;
  cursor: help;
}
.item-tooltip:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 100%;
  left: 0;
  background: rgba(0,0,0,0.95);
  color: #e7eaf0;
  padding: 8px 10px;
  border-radius: 6px;
  white-space: pre-wrap;
  font-size: 12px;
  z-index: 100;
  margin-bottom: 4px;
  min-width: 200px;
  border: 1px solid #3a4350;
}

/* Shop item states */
.shop-item.unaffordable {
  opacity: 0.5;
  background: #1a1a1a;
}
.shop-item.unaffordable .price {
  color: #ef4444;
}
.shop-item.owned {
  border-color: #10b981;
  background: #0a2419;
}

/* Enemy attack indicator */
.enemy-attack-indicator {
  display: inline-block;
  padding: 2px 6px;
  background: #ef4444;
  color: #fff;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  margin-left: 8px;
}

/* Generic Shop Clerk NPC */
.shop-clerk {
  width: 96px;
  height: 128px;
  border-radius: 8px;
  background: linear-gradient(180deg,#2a2f38,#0f1216);
  border: 1px solid #3a4350;
  position: relative;
  box-shadow: 0 6px 18px rgba(0,0,0,0.35);
  cursor: pointer;
}
.shop-clerk::before {
  content: '';
  position: absolute;
  left: 50%; top: 10px;
  width: 54px; height: 54px;
  transform: translateX(-50%);
  background: radial-gradient(circle at 30% 30%, #cbd5e1 0%, #94a3b8 60%, #64748b 100%);
  border-radius: 50%;
}
.shop-clerk::after {
  content: '';
  position: absolute;
  left: 50%; top: 68px;
  width: 64px; height: 46px;
  transform: translateX(-50%);
  background: linear-gradient(180deg,#6b7280,#374151);
  border-radius: 6px;
}
.shop-clerk:hover { border-color: #4aa3ff; }
.shop-clerk-label {
  font-size: 12px; color: #e7eaf0; text-align: center; margin-top: 6px;
}
.shop-intro { display:flex; align-items:center; gap:14px; margin-bottom: 12px; }
.shop-intro .bubble { background:#0f1216; border:1px solid #2a2f38; border-radius:10px; padding:10px; color:#cbd5e1; font-size:13px; }
.shop-hint { font-size:12px; color:#9aa3af; }

/* Cooldown ready indicator */
.cd-ready {
  border-color: #10b981 !important;
  box-shadow: 0 0 8px rgba(16, 185, 129, 0.4);
}

/* Group enemy rows */
.enemy-row {
  display: flex;
  justify-content: space-between;
  padding: 8px;
  margin: 4px 0;
  border: 1px solid #262b34;
  border-radius: 6px;
  background: #12161b;
  cursor: pointer;
  transition: all 0.2s;
}
.enemy-row:hover {
  border-color: #3a4350;
  background: #1a1f26;
}
.enemy-row.active-target {
  border-color: #4aa3ff;
  background: #0f1a2e;
}
.er-name { font-weight: 600; }
.er-hp { color: #cbd5e1; font-size: 12px; }

/* Save confirmation modal */
.confirm-modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
.confirm-content {
  background: var(--panel);
  border: 1px solid #3a4350;
  border-radius: 10px;
  padding: 20px;
  max-width: 400px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.5);
}
.confirm-buttons {
  display: flex;
  gap: 10px;
  margin-top: 16px;
  justify-content: flex-end;
}

/* NPC screen */
#screen-npc .portrait {
  width: 80px; height: 80px; border-radius: 8px; background:#0f1216; border:1px solid #2a2f38; margin-right:12px;
}
.npc-line { margin: 6px 0; color: #e7eaf0; }
.portrait-guard_lyra { background-image: url('./portraits/guard.png'); background-size: cover; }
.portrait-blacksmith_garr { background-image: url('./portraits/blacksmith.png'); background-size: cover; }
.portrait-alchemist_miri { background-image: url('./portraits/alchemist.png'); background-size: cover; }
.portrait-innkeeper_bren { background-image: url('./portraits/innkeeper.png'); background-size: cover; }
.portrait-questmaster_rho { background-image: url('./portraits/questmaster.png'); background-size: cover; }
.portrait-historian_ane { background-image: url('./portraits/historian.png'); background-size: cover; }
.portrait-child_fen { background-image: url('./portraits/child.png'); background-size: cover; }

/* responsive */
@media (max-width:760px){
  #game-root{max-width:680px}
  .battle-top{grid-template-columns:1fr}
}

/* ===== Enhanced Character Creation Screen ===== */
.character-creation-container {
  width: 100%;
  max-width: 1200px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  /* Extra bottom padding so sticky footer does not cover lowest panels */
  padding-bottom: 120px;
}

.cc-header {
  text-align: center;
}

.cc-header h1 {
  font-size: 36px;
  margin: 0;
  background: linear-gradient(135deg, #4aa3ff, #8b5cf6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.cc-header h2 {
  font-size: 18px;
  color: var(--muted);
  margin: 8px 0 0;
}

/* Three-column layout */
.cc-layout {
  display: grid;
  grid-template-columns: 280px 1fr 320px;
  gap: 20px;
  align-items: start;
}

/* Left: Race List */
.cc-race-list h3 {
  margin: 0 0 16px;
  font-size: 18px;
  color: var(--text);
}

.race-options {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.race-card {
  background: var(--panel);
  border: 2px solid #2b313b;
  border-radius: 10px;
  padding: 16px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 12px;
}

.race-card:hover {
  border-color: #3a4350;
  background: #1a1f26;
  transform: translateX(4px);
}

.race-card.selected {
  border-color: var(--accent);
  background: linear-gradient(135deg, rgba(74, 163, 255, 0.1), rgba(139, 92, 246, 0.05));
  box-shadow: 0 0 12px rgba(74, 163, 255, 0.3);
}

.race-portrait {
  width: 48px;
  height: 48px;
  border-radius: 8px;
  background: #0f1216;
  border: 1px solid #2a2f38;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
}

.race-name {
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
}

/* Center: Character Details */
.cc-center {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.cc-name-class {
  background: var(--panel);
  border: 1px solid #22262e;
  border-radius: 10px;
  padding: 16px;
}

.cc-stat-allocation {
  background: var(--panel);
  border: 1px solid #22262e;
  border-radius: 10px;
  padding: 16px;
}

.points-remaining {
  color: var(--accent);
  font-weight: bold;
  font-size: 16px;
  margin-left: 8px;
}

.stats-grid-cc {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  margin-top: 12px;
}

.stat-item {
  background: #0f1216;
  border: 1px solid #262b34;
  border-radius: 8px;
  padding: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.stat-label {
  font-size: 14px;
  font-weight: 600;
  color: var(--muted);
}

.stat-value {
  font-size: 20px;
  font-weight: bold;
  color: var(--accent);
  min-width: 30px;
  text-align: center;
}

.stat-controls button {
  width: 32px;
  height: 32px;
  padding: 0;
  font-size: 18px;
  font-weight: bold;
}

.cc-stat-info {
  background: var(--panel);
  border: 1px solid #22262e;
  border-radius: 10px;
  padding: 16px;
}

.cc-stat-info h4 {
  margin: 0 0 12px;
  font-size: 16px;
  color: var(--text);
}

.stat-explanations {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.stat-explain-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: var(--muted);
}

.stat-icon {
  font-size: 18px;
  width: 24px;
  text-align: center;
}

.stat-explain-item strong {
  color: var(--text);
  min-width: 40px;
}

/* Right: Race Details & Preview */
.cc-right {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.race-details {
  background: var(--panel);
  border: 1px solid #22262e;
  border-radius: 10px;
  padding: 16px;
  min-height: 200px;
}

.race-details h3 {
  margin: 0 0 12px;
  font-size: 16px;
  color: var(--text);
}

.race-lore {
  font-size: 13px;
  color: var(--muted);
  font-style: italic;
  margin-bottom: 12px;
  line-height: 1.6;
}

.race-bonuses {
  margin: 12px 0;
  padding: 10px;
  background: #0f1216;
  border-radius: 6px;
  border-left: 3px solid var(--accent);
}

.race-bonus-item {
  font-size: 13px;
  color: var(--ok);
  margin: 4px 0;
}

.race-playstyle {
  margin-top: 12px;
  padding: 10px;
  background: rgba(74, 163, 255, 0.05);
  border-radius: 6px;
  font-size: 13px;
  color: var(--text);
}

.race-playstyle strong {
  color: var(--accent);
}

/* Human bonus selector */
.human-bonus-selector {
  margin-top: 12px;
  padding: 10px;
  background: #12161b;
  border: 1px solid #262b34;
  border-radius: 8px;
}
.human-bonus-selector .selector-label {
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 8px;
}
.human-bonus-selector .bonus-choice {
  margin-right: 6px;
  margin-bottom: 6px;
  background: #0f1216;
  border: 1px solid #2a2f38;
  padding: 6px 10px;
  font-size: 12px;
  cursor: pointer;
  border-radius: 6px;
  transition: all .15s;
}
.human-bonus-selector .bonus-choice:hover {
  border-color: #3a4350;
  background: #1a1f26;
}
.human-bonus-selector .bonus-choice.active {
  border-color: var(--accent);
  box-shadow: 0 0 8px rgba(74,163,255,0.4);
}

.cc-preview {
  background: var(--panel);
  border: 1px solid #22262e;
  border-radius: 10px;
  padding: 16px;
}

.cc-preview h4 {
  margin: 0 0 12px;
  font-size: 14px;
  color: var(--text);
}

.preview-stats {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.preview-row {
  display: flex;
  justify-content: space-between;
  padding: 6px 10px;
  background: #0f1216;
  border-radius: 6px;
  font-size: 14px;
}

.preview-row span:first-child {
  color: var(--muted);
  font-weight: 600;
}

.preview-row span:last-child {
  color: var(--accent);
  font-weight: bold;
}

.preview-derived {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid #262b34;
}

.preview-note {
  font-size: 12px;
  color: var(--muted);
  font-style: italic;
  text-align: center;
}

/* Footer */
.cc-footer {
  display: flex;
  justify-content: center;
  padding: 10px 0 4px;
  position: sticky;
  bottom: 0;
  background: linear-gradient(180deg, rgba(14,15,18,0.4), rgba(14,15,18,0.9));
  backdrop-filter: blur(4px);
  border-top: 1px solid #22262e;
  margin-top: auto;
}

.cc-footer button {
  min-width: 200px;
  padding: 12px 24px;
  font-size: 16px;
  font-weight: 600;
}

.cc-footer button.enabled {
  box-shadow: 0 0 12px rgba(74,163,255,0.35);
}

/* Responsive adjustments */
@media (max-width: 1100px) {
  .cc-layout {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  
  .cc-race-list .race-options {
    flex-direction: row;
    flex-wrap: wrap;
  }
  
  .race-card {
    flex: 1;
    min-width: 140px;
  }
  
  .stats-grid-cc {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 700px) {
  .stats-grid-cc {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* World Map */
#screen-world-map .world-map-bg{
  position: relative; min-height: 420px; background-image: url('./backgrounds/world-map.png');
  background-size: cover; background-position: center; border:1px solid #2a2f38; border-radius: 10px;
}
#world-map-nodes, #world-map-markers{ position:absolute; inset:0; }
.map-node{ position:absolute; transform:translate(-50%,-50%); left:50%; top:50%;
  background:#12161b; border:2px solid #4aa3ff; color:#e7eaf0; border-radius:10px; padding:6px 8px; cursor:pointer; font-size:12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.4);
}
.map-node.locked{ opacity:0.4; border-color:#3a4350; cursor:not-allowed; }
.map-node.current{ animation:pulse-glow 2s ease-in-out infinite; }
.map-node.newly-unlocked{ box-shadow:0 0 12px rgba(16,185,129,0.6); }
.map-node.easy{ border-color:#10b981; }
.map-node.fair{ border-color:#f59e0b; }
.map-node.hard{ border-color:#ef4444; }
.map-node.impossible{ border-color:#6b7280; }
.map-node:hover::after, .map-marker:hover::after{
  content: attr(data-tooltip);
  position:absolute; left:50%; top:-8px; transform:translate(-50%,-100%);
  background:rgba(0,0,0,0.95); color:#fff; padding:6px 8px; border-radius:6px; font-size:11px; white-space:pre;
  border:1px solid #3a4350;
}
.node-label{ pointer-events:none; }
.map-marker{ position:absolute; width:10px; height:10px; border-radius:50%; background:#f59e0b; box-shadow:0 0 8px rgba(245,158,11,0.6); }
.world-map-panel.traveling{ filter:blur(1px) brightness(0.9); }

